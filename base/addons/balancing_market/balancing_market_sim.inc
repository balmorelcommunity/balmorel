*Balancing market introduced by Juan Gea-Bermudez and Polyneikis Kanellas

*Fixing commitment status from energy dispatch run
$ifi not %SOLVETYPE%==MIP $ifi %UnitComm%==yes VUCON.FX(IY411,IA,IGUC,IS3,T)$((GDATA(IGUC,'GDUCDTMIN') GT WEIGHT_S(IS3) OR GDATA(IGUC,'GDUCUTMIN') GT WEIGHT_S(IS3)) AND GKFX(IY411,IA,IGUC) AND (NOT SUM(Y$(YVALUE(Y) LE YVALUE(IY411)),IAGKNY(Y,IA,IGUC)))) = UCON(IY411,IA,IGUC,IS3,T);
$ifi     %SOLVETYPE%==MIP $ifi %UnitComm%==yes VUCON.FX(IY411,IA,IGUC,IS3,T)$((GDATA(IGUC,'GDUCDTMIN') GT WEIGHT_S(IS3) OR GDATA(IGUC,'GDUCUTMIN') GT WEIGHT_S(IS3)) AND GKFX(IY411,IA,IGUC) AND (NOT SUM(Y$(YVALUE(Y) LE YVALUE(IY411)),IAGKNY(Y,IA,IGUC)))) = ROUND(UCON(IY411,IA,IGUC,IS3,T));
$ifi not %SOLVETYPE%==MIP $ifi %UnitComm%==yes VUCON_STOLOAD.FX(IY411,IA,IGUC,IS3,T)$((GDATA(IGUC,'GDUCDTMIN') GT WEIGHT_S(IS3) OR GDATA(IGUC,'GDUCUTMIN') GT WEIGHT_S(IS3)) AND GKFX(IY411,IA,IGUC) AND (NOT SUM(Y$(YVALUE(Y) LE YVALUE(IY411)),IAGKNY(Y,IA,IGUC))) AND (IGESTOALL(IGUC) OR IGHSTOALL(IGUC))) = UCON_STOLOAD(IY411,IA,IGUC,IS3,T);
$ifi     %SOLVETYPE%==MIP $ifi %UnitComm%==yes VUCON_STOLOAD.FX(IY411,IA,IGUC,IS3,T)$((GDATA(IGUC,'GDUCDTMIN') GT WEIGHT_S(IS3) OR GDATA(IGUC,'GDUCUTMIN') GT WEIGHT_S(IS3)) AND GKFX(IY411,IA,IGUC) AND (NOT SUM(Y$(YVALUE(Y) LE YVALUE(IY411)),IAGKNY(Y,IA,IGUC))) AND (IGESTOALL(IGUC) OR IGHSTOALL(IGUC))) = ROUND(UCON_STOLOAD(IY411,IA,IGUC,IS3,T));

$ontext
*Limiting maximum back-up from previous results to estimate additional reserves need in the market (by default not activated)
VGE_T.UP(IY411,IA,G,IS3,T)$(GDATA(G,'GDTECHGROUP') EQ BACKUP_ELECTRICITY AND GKFX(IY411,IA,G))=SMAX(SSS,SMAX(TTT,GE_T(IY411,IA,G,SSS,TTT)));
$ifi not %NOHEATMARKET%==yes VGH_T.UP(IY411,IA,G,IS3,T)$(GDATA(G,'GDTECHGROUP') EQ BACKUP_HEAT AND GKFX(IY411,IA,G))=SMAX(SSS,SMAX(TTT,GH_T(IY411,IA,G,SSS,TTT)));
$offtext





